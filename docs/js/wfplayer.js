/*!
 * WFPlayer.js v1.0.9
 * Github: https://github.com/zhw2590582/WFPlayer#readme
 * (c) 2017-2019 Harvey Zack
 * Released under the MIT License.
 */

!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).WFPlayer=e()}(this,function(){"use strict";var r=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t};var i=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}var l=e(function(e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?e.exports=r=function(t){return n(t)}:e.exports=r=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":n(t)},r(t)}e.exports=r});var o=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var a=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?o(t):e},u=e(function(e){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(t)}e.exports=n});function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=function(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t},f=e(function(n){function r(t,e){return n.exports=r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},r(t,e)}n.exports=r});var d=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)},h=e(function(t,e){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return t.constructor?t.constructor.name:null}function c(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:["option"];return s(t,e,n),l(t,e,n),function(o,a,u){var t=f(a),e=f(o);if("object"===t){if("object"!==e)throw new Error("[Type Error]: '".concat(u.join("."),"' require 'object' type, but got '").concat(e,"'"));Object.keys(a).forEach(function(t){var e=o[t],n=a[t],r=u.slice();r.push(t),s(e,n,r),l(e,n,r),c(e,n,r)})}if("array"===t){if("array"!==e)throw new Error("[Type Error]: '".concat(u.join("."),"' require 'array' type, but got '").concat(e,"'"));o.forEach(function(t,e){var n=o[e],r=a[e]||a[0],i=u.slice();i.push(e),s(n,r,i),l(n,r,i),c(n,r,i)})}}(t,e,n),t}function s(t,e,n){if("string"===f(e)){var r=f(t);if(!(-1<e.indexOf("|")?e.split("|").map(function(t){return t.toLowerCase().trim()}).filter(Boolean).some(function(t){return r===t}):e.toLowerCase().trim()===r))throw new Error("[Type Error]: '".concat(n.join("."),"' require '").concat(e,"' type, but got '").concat(r,"'"))}}function l(t,e,n){if("function"===f(e)){var r=e(t,f(t),n);if(!0!==r){var i=f(r);throw"string"===i?new Error(r):"error"===i?r:new Error("[Validator Error]: The scheme for '".concat(n.join("."),"' validator require return true, but got '").concat(r,"'"))}}}var i,f;t.exports=(i=Object.prototype.toString,c.kindOf=f=function(t){if(void 0===t)return"undefined";if(null===t)return"null";var e=n(t);if("boolean"===e)return"boolean";if("string"===e)return"string";if("number"===e)return"number";if("symbol"===e)return"symbol";if("function"===e)return function(t){return"GeneratorFunction"===r(t)}(t)?"generatorfunction":"function";if(function(t){return Array.isArray?Array.isArray(t):t instanceof Array}(t))return"array";if(function(t){return!(!t.constructor||"function"!=typeof t.constructor.isBuffer)&&t.constructor.isBuffer(t)}(t))return"buffer";if(function(t){try{if("number"==typeof t.length&&"function"==typeof t.callee)return!0}catch(t){if(-1!==t.message.indexOf("callee"))return!0}return!1}(t))return"arguments";if(function(t){return t instanceof Date||"function"==typeof t.toDateString&&"function"==typeof t.getDate&&"function"==typeof t.setDate}(t))return"date";if(function(t){return t instanceof Error||"string"==typeof t.message&&t.constructor&&"number"==typeof t.constructor.stackTraceLimit}(t))return"error";if(function(t){return t instanceof RegExp||"string"==typeof t.flags&&"boolean"==typeof t.ignoreCase&&"boolean"==typeof t.multiline&&"boolean"==typeof t.global}(t))return"regexp";switch(r(t)){case"Symbol":return"symbol";case"Promise":return"promise";case"WeakMap":return"weakmap";case"WeakSet":return"weakset";case"Map":return"map";case"Set":return"set";case"Int8Array":return"int8array";case"Uint8Array":return"uint8array";case"Uint8ClampedArray":return"uint8clampedarray";case"Int16Array":return"int16array";case"Uint16Array":return"uint16array";case"Int32Array":return"int32array";case"Uint32Array":return"uint32array";case"Float32Array":return"float32array";case"Float64Array":return"float64array"}if(function(t){return"function"==typeof t.throw&&"function"==typeof t.return&&"function"==typeof t.next}(t))return"generator";switch(e=i.call(t)){case"[object Object]":return"object";case"[object Map Iterator]":return"mapiterator";case"[object Set Iterator]":return"setiterator";case"[object String Iterator]":return"stringiterator";case"[object Array Iterator]":return"arrayiterator"}return e.slice(8,-1).toLowerCase().replace(/\s/g,"")},c)}),p=function(){function t(){i(this,t)}return s(t,[{key:"on",value:function(t,e,n){var r=this.e||(this.e={});return(r[t]||(r[t]=[])).push({fn:e,ctx:n}),this}},{key:"once",value:function(r,i,o){var a=this;function u(){a.off(r,u);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];i.apply(o,e)}return u._=i,this.on(r,u,o)}},{key:"emit",value:function(t){for(var e=((this.e||(this.e={}))[t]||[]).slice(),n=arguments.length,r=new Array(1<n?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0;o<e.length;o+=1)e[o].fn.apply(e[o].ctx,r);return this}},{key:"off",value:function(t,e){var n=this.e||(this.e={}),r=n[t],i=[];if(r&&e)for(var o=0,a=r.length;o<a;o+=1)r[o].fn!==e&&r[o].fn._!==e&&i.push(r[o]);return i.length?n[t]=i:delete n[t],this}}]),t}(),y=function(){function t(){i(this,t),this.destroyEvents=[],this.proxy=this.proxy.bind(this)}return s(t,[{key:"proxy",value:function(e,t,n,r){var i=this,o=3<arguments.length&&void 0!==r?r:{};Array.isArray(t)?t.forEach(function(t){return i.proxy(e,t,n,o)}):(e.addEventListener(t,n,o),this.destroyEvents.push(function(){e.removeEventListener(t,n,o)}))}},{key:"destroy",value:function(){this.destroyEvents.forEach(function(t){return t()})}}]),t}();var m=function(t){return-1!==Function.toString.call(t).indexOf("[native code]")},v=e(function(r){function i(t,e,n){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?r.exports=i=function(t,e,n){var r=[null];r.push.apply(r,e);var i=new(Function.bind.apply(t,r));return n&&f(i,n.prototype),i}:r.exports=i=Reflect.construct,i.apply(null,arguments)}r.exports=i}),n=e(function(e){function r(t){var n="function"==typeof Map?new Map:void 0;return e.exports=r=function(t){if(null===t||!m(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return v(t,arguments,u(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),f(e,t)},r(t)}e.exports=r}),g=e(function(t,e){t.exports={d2t:function(t){if(function(t){return t=String(t),/^(\d+)(\.\d{1,3})?$/.test(t)}(t)){var e=new Date(null),n=String(t).split("."),r=n[0],i=n[1]?n[1].padEnd(3,0):0;return e.setSeconds(Number(r)),e.setMilliseconds(Number(i)),e.toISOString().substr(11,12)}throw new Error("The format of the duration is incorrect: "+t)},t2d:function(t){if(function(t){return/^(\d+):([0-5][0-9]):([0-5][0-9])(\.\d{3})?$/.test(t)}(t)){var e=t.split(".")[0].split(":"),n=Number(t.split(".")[1]||0)/1e3,r=3600*Number(e[0]),i=60*Number(e[1]),o=Number(e[2]);return r+i+o+n}throw new Error("The format of the time is incorrect: "+t)}}}),b=function(t){function n(t){var e;return i(this,n),(e=a(this,u(n).call(this,t))).name="WFPlayerError",e}return d(n,t),n}(n(Error));function w(t,e){if(!t)throw new b(e);return t}function x(t){var e=0<arguments.length&&void 0!==t?t:0;return g.d2t(e.toFixed(3))}function C(t,e,n){return Math.max(Math.min(t,Math.max(e,n)),Math.min(e,n))}var S=function(){function e(t){i(this,e),this.wf=t,this.canvas=null,this.update()}return s(e,[{key:"update",value:function(){var t=this.wf.options,e=t.container,n=t.pixelRatio,r=e.clientWidth,i=e.clientHeight;this.canvas?(this.canvas.width=r*n,this.canvas.height=i*n):(w(this.wf.constructor.instances.every(function(t){return t.options.container!==e}),"Cannot mount multiple instances on the same dom element, please destroy the previous instance first."),w(r&&i,"The width and height of the container cannot be 0"),e.innerHTML="",e.style.position="relative",this.canvas=document.createElement("canvas"),this.canvas.width=r*n,this.canvas.height=i*n,this.canvas.style.width="100%",this.canvas.style.height="100%",e.appendChild(this.canvas))}},{key:"exportImage",value:function(){var t=document.createElement("a");t.style.display="none",t.href=this.canvas.toDataURL("image/png"),t.download="".concat(Date.now(),".png"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}},{key:"destroy",value:function(){this.wf.options.container.innerHTML=""}}]),e}(),k=function(){function n(t){var e=this;i(this,n),this.wf=t,this.canvas=t.template.canvas,this.ctx=this.canvas.getContext("2d"),this.gridNum=0,this.gridGap=0,this.beginTime=0,this.update(),t.on("options",function(){e.update()}),t.on("channelData",function(){e.update()})}return s(n,[{key:"update",value:function(){var t=this.wf,e=t.currentTime,n=t.options,r=n.cursor,i=n.grid,o=n.ruler,a=n.wave,u=n.duration,c=n.padding;this.gridNum=10*u+2*c,this.gridGap=this.canvas.width/this.gridNum,this.beginTime=Math.floor(e/u)*u,this.drawBackground(),i&&this.drawGrid(),o&&this.drawRuler(),a&&this.drawWave(),r&&this.drawCursor()}},{key:"drawBackground",value:function(){var t=this.wf.options,e=t.backgroundColor,n=t.paddingColor,r=t.padding,i=this.canvas,o=i.width,a=i.height;this.ctx.clearRect(0,0,o,a),this.ctx.fillStyle=e,this.ctx.fillRect(0,0,o,a),this.ctx.fillStyle=n,this.ctx.fillRect(0,0,r*this.gridGap,a),this.ctx.fillRect(o-r*this.gridGap,0,r*this.gridGap,a)}},{key:"drawWave",value:function(){for(var t=this.wf,e=t.currentTime,n=t.options,r=n.progress,i=n.waveColor,o=n.progressColor,a=n.duration,u=n.padding,c=n.waveScale,s=t.decoder,l=s.channelData,f=s.audiobuffer.sampleRate,d=this.canvas,h=d.width,p=d.height/2,y=h-this.gridGap*u*2,m=C(this.beginTime*f,0,1/0),v=C((this.beginTime+a)*f,m,1/0),g=Math.floor((v-m)/y),b=u*this.gridGap+(e-this.beginTime)*this.gridGap*10,w=0,x=0,S=1,k=-1,E=m;E<v;E+=1){w+=1;var j=l[E]||0;if(j<S?S=j:k<j&&(k=j),g<=w&&x<y){x+=1;var T=this.gridGap*u+x;this.ctx.fillStyle=r&&T<=b?o:i,this.ctx.fillRect(T,(1+S*c)*p,1,Math.max(1,(k-S)*p*c)),w=0,k=-(S=1)}}}},{key:"drawGrid",value:function(){var t=this.wf.options,e=t.gridColor,n=t.pixelRatio,r=this.canvas,i=r.width,o=r.height;this.ctx.fillStyle=e;for(var a=0;a<this.gridNum;a+=1)this.ctx.fillRect(this.gridGap*a,0,n,o);for(var u=0;u<o/this.gridGap;u+=1)this.ctx.fillRect(0,this.gridGap*u,i,n)}},{key:"drawRuler",value:function(){var t=this.wf.options,e=t.rulerColor,n=t.pixelRatio,r=t.padding,i=t.rulerAtTop,o=this.canvas.height;this.ctx.font="".concat(11*n,"px Arial"),this.ctx.fillStyle=e;for(var a=-1,u=0;u<this.gridNum;u+=1)u&&r<=u&&u<=this.gridNum-r&&(u-r)%10==0?(a+=1,this.ctx.fillRect(this.gridGap*u,i?0:o-15*n,n,15*n),this.ctx.fillText(x(this.beginTime+a).split(".")[0],this.gridGap*u-11*n*2+n,i?30*n:o-30*n+11)):u&&(u-r)%5==0&&this.ctx.fillRect(this.gridGap*u,i?0:o-7.5*n,n,7.5*n)}},{key:"drawCursor",value:function(){var t=this.wf,e=t.currentTime,n=t.options,r=n.cursorColor,i=n.pixelRatio,o=n.padding,a=this.canvas.height;this.ctx.fillStyle=r,this.ctx.fillRect(o*this.gridGap+(e-this.beginTime)*this.gridGap*10,0,i,a)}}]),n}();var E=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},j="object"==typeof t&&t&&t.Object===Object&&t,T="object"==typeof self&&self&&self.Object===Object&&self,O=j||T||Function("return this")(),A=function(){return O.Date.now()},D=O.Symbol,R=Object.prototype,I=R.hasOwnProperty,z=R.toString,G=D?D.toStringTag:void 0;var M=function(t){var e=I.call(t,G),n=t[G];try{var r=!(t[G]=void 0)}catch(t){}var i=z.call(t);return r&&(e?t[G]=n:delete t[G]),i},P=Object.prototype.toString;var L=function(t){return P.call(t)},N=D?D.toStringTag:void 0;var W=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":N&&N in Object(t)?M(t):L(t)};var F=function(t){return null!=t&&"object"==typeof t};var _=function(t){return"symbol"==typeof t||F(t)&&"[object Symbol]"==W(t)},U=/^\s+|\s+$/g,B=/^[-+]0x[0-9a-f]+$/i,q=/^0b[01]+$/i,$=/^0o[0-7]+$/i,H=parseInt;var V=function(t){if("number"==typeof t)return t;if(_(t))return NaN;if(E(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=E(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(U,"");var n=q.test(t);return n||$.test(t)?H(t.slice(2),n?2:8):B.test(t)?NaN:+t},X=Math.max,J=Math.min;var K=function(r,n,t){var i,o,a,u,c,s,l=0,f=!1,d=!1,e=!0;if("function"!=typeof r)throw new TypeError("Expected a function");function h(t){var e=i,n=o;return i=o=void 0,l=t,u=r.apply(n,e)}function p(t){var e=t-s;return void 0===s||n<=e||e<0||d&&a<=t-l}function y(){var t=A();if(p(t))return m(t);c=setTimeout(y,function(t){var e=n-(t-s);return d?J(e,a-(t-l)):e}(t))}function m(t){return c=void 0,e&&i?h(t):(i=o=void 0,u)}function v(){var t=A(),e=p(t);if(i=arguments,o=this,s=t,e){if(void 0===c)return function(t){return l=t,c=setTimeout(y,n),f?h(t):u}(s);if(d)return clearTimeout(c),c=setTimeout(y,n),h(s)}return void 0===c&&(c=setTimeout(y,n)),u}return n=V(n)||0,E(t)&&(f=!!t.leading,a=(d="maxWait"in t)?X(V(t.maxWait)||0,n):a,e="trailing"in t?!!t.trailing:e),v.cancel=function(){void 0!==c&&clearTimeout(c),i=s=o=c=void(l=0)},v.flush=function(){return void 0===c?u:m(A())},v};var Q=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return E(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),K(t,e,{leading:r,maxWait:e,trailing:i})},Y=function(){function n(t){var e=this;i(this,n),this.wf=t,this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.throttleDecodeAudioData=Q(this.decodeAudioData,500),this.audiobuffer=this.audioCtx.createBuffer(2,22050,44100),this.channelData=new Float32Array,this.wf.on("loading",function(t){e.throttleDecodeAudioData(t)})}return s(n,[{key:"decodeAudioData",value:function(t){var e=this,n=this.wf,r=n.options.channel,i=n.duration;this.audioCtx.decodeAudioData(t.buffer).then(function(t){e.audiobuffer=t,e.wf.emit("audiobuffer",e.audiobuffer),e.wf.emit("decodeing",e.audiobuffer.duration/i),e.channelData=t.getChannelData(r),e.wf.emit("channelData",e.channelData)}).catch(function(t){w(!1,"It seems that the AudioContext decoding get wrong: ".concat(t.message.trim()))})}},{key:"destroy",value:function(){this.audiobuffer=this.audioCtx.createBuffer(2,22050,44100),this.channelData=new Float32Array}}]),n}(),Z=function(){function e(t){i(this,e),this.wf=t,this.fileSize=0,this.loadSize=0,this.data=new Uint8Array,this.reader=null,this.abortController=null}return s(e,[{key:"load",value:function(t){var n=this;this.destroy(),this.abortController=new AbortController;var e=this.wf.options,r=e.withCredentials,i=e.cors,o=e.headers;return this.wf.emit("loadStart"),fetch(t,{credentials:r?"include":"omit",mode:i?"cors":"no-cors",signal:this.abortController.signal,headers:o}).then(function(t){return t.body&&"function"==typeof t.body.getReader?(n.fileSize=Number(t.headers.get("content-length")),n.wf.emit("fileSize",n.fileSize),n.reader=t.body.getReader(),function r(){var i=this;return this.reader.read().then(function(t){var e=t.done,n=t.value;return e?(i.wf.emit("loadEnd"),null):(i.loadSize+=n.byteLength,i.wf.emit("downloading",i.loadSize/i.fileSize),i.data=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r=e[0].constructor;return e.reduce(function(t,e){var n=new r((0|t.byteLength)+(0|e.byteLength));return n.set(t,0),n.set(e,0|t.byteLength),n},new r)}(i.data,n),i.wf.emit("loading",i.data.slice()),r.call(i))})}.call(n)):t.arrayBuffer()}).then(function(t){if(t&&t.byteLength){var e=new Uint8Array(t);n.fileSize=e.byteLength,n.wf.emit("fileSize",n.fileSize),n.loadSize=e.byteLength,n.wf.emit("downloading",n.loadSize/n.fileSize),n.wf.emit("loading",e),n.wf.emit("loadEnd")}})}},{key:"destroy",value:function(){this.fileSize=0,this.loadSize=0,this.data=new Uint8Array,this.reader&&(this.reader.cancel(),this.reader=null),this.abortController&&(this.abortController.abort(),this.abortController=null)}}]),e}(),tt=function(){function n(t){var e=this;i(this,n),this.wf=t,this.playTimer=null,this.wf.on("load",function(){e.clickInit(),e.resizeInit(),e.playInit()})}return s(n,[{key:"getTimeFromEvent",value:function(t){var e=this.wf,n=e.currentTime,r=e.template.canvas,i=e.options,o=i.duration,a=i.padding,u=i.container,c=i.pixelRatio,s=10*o+2*a,l=r.width/s,f=C(t.pageX-u.offsetLeft-a*l/c,0,1/0),d=Math.floor(n/o)*o;return C(f/l*c/10+d,d,d+o)}},{key:"clickInit",value:function(){var n=this,t=this.wf,e=t.template.canvas;(0,t.events.proxy)(e,["click","contextmenu"],function(t){var e=n.getTimeFromEvent(t);n.wf.emit(t.type,e,t)})}},{key:"resizeInit",value:function(){var t=this,e=this.wf,n=e.template,r=e.drawer,i=e.events.proxy,o=e.options.container,a=document.createElement("object");a.setAttribute("aria-hidden","true"),a.setAttribute("tabindex",-1),a.type="text/html",a.data="about:blank",function e(n,r,t){return"object"===l(r)&&Object.keys(r).forEach(function(t){e(n,t,r[t])}),n.style[r]=t,n}(a,{display:"block",position:"absolute",top:"0",left:"0",height:"100%",width:"100%",overflow:"hidden",pointerEvents:"none",zIndex:"-1"});var u=o.clientWidth,c=o.clientWidth,s=Q(function(){u=o.clientWidth,c=o.clientWidth,n.update(),r.update(),t.wf.emit("resize")},500);i(a,"load",function(){i(a.contentDocument.defaultView,"resize",function(){o.clientWidth===u&&o.clientWidth===c||s()})}),o.appendChild(a),i(window,"orientationchange",function(){s()})}},{key:"playInit",value:function(){var t=this.wf,n=t.drawer,r=t.options.mediaElement;r&&function t(){var e=this;this.playTimer=requestAnimationFrame(function(){e.wf.playing&&(n.update(),e.wf.emit("playing",r.currentTime)),e.wf.isDestroy||t.call(e)})}.call(this)}},{key:"destroy",value:function(){cancelAnimationFrame(this.playTimer)}}]),n}();function et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var nt=0,rt=[];return function(){function n(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return i(this,n),(t=a(this,u(n).call(this)))._currentTime=0,t.isDestroy=!1,t.options={},t.setOptions(e),t.events=new y(o(t)),t.template=new S(o(t)),t.decoder=new Y(o(t)),t.drawer=new k(o(t)),t.controller=new tt(o(t)),t.loader=new Z(o(t)),nt+=1,t.id=nt,rt.push(o(t)),t}return d(n,p),s(n,null,[{key:"instances",get:function(){return rt}},{key:"version",get:function(){return"1.0.9"}},{key:"env",get:function(){return'"production"'}},{key:"default",get:function(){return{container:"#waveform",mediaElement:null,wave:!0,waveColor:"rgba(255, 255, 255, 0.1)",backgroundColor:"rgb(28, 32, 34)",paddingColor:"rgba(255, 255, 255, 0.05)",cursor:!0,cursorColor:"#ff0000",progress:!0,progressColor:"rgba(255, 255, 255, 0.5)",grid:!0,gridColor:"rgba(255, 255, 255, 0.05)",ruler:!0,rulerColor:"rgba(255, 255, 255, 0.5)",rulerAtTop:!0,withCredentials:!1,cors:!1,headers:{},channel:0,duration:10,padding:5,waveScale:.8,pixelRatio:window.devicePixelRatio}}},{key:"scheme",get:function(){function t(n,r,i,o){return function(t,e){return w("number"===e,"".concat(n," expects to receive number as a parameter, but got ").concat(e,".")),w(r<=t&&t<=i&&(!o||Number.isInteger(t)),"'options.".concat(n,"' expect ").concat(o?"an integer ":"a ","number that >= ").concat(r," and <= ").concat(i,", but got ").concat(t,".")),!0}}return{container:"htmlelement|htmldivelement",mediaElement:"null|htmlvideoelement|htmlaudioelement",wave:"boolean",waveColor:"string",backgroundColor:"string",paddingColor:"string",cursor:"boolean",cursorColor:"string",progress:"boolean",progressColor:"string",grid:"boolean",gridColor:"string",ruler:"boolean",rulerColor:"string",rulerAtTop:"boolean",withCredentials:"boolean",cors:"boolean",headers:"object",channel:t("channel",0,5,!0),duration:t("duration",1,100,!0),padding:t("padding",1,100,!0),waveScale:t("waveScale",.1,10,!1),pixelRatio:t("pixelRatio",1,10,!1)}}}]),s(n,[{key:"setOptions",value:function(t){var e=0<arguments.length&&void 0!==t?t:{};return w("object"===h.kindOf(e),"setOptions expects to receive object as a parameter."),"string"==typeof e.container&&(e.container=document.querySelector(e.container)),"string"==typeof e.mediaElement&&(e.mediaElement=document.querySelector(e.mediaElement)),this.options=h(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?et(n,!0).forEach(function(t){r(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):et(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n.default,{},this.options,{},e),n.scheme),this.emit("options",this.options),this}},{key:"load",value:function(t){return(t instanceof HTMLVideoElement||t instanceof HTMLAudioElement)&&(t=(this.options.mediaElement=t).src),w("string"==typeof t&&t.trim(),"The load target is not a string. If you are loading a mediaElement, make sure the mediaElement.src is not empty."),this.loader.load(t),this.emit("load"),this}},{key:"seek",value:function(t){return w("number"==typeof t,"seek expects to receive number as a parameter."),this._currentTime=C(t,0,this.duration),this.drawer.update(),this}},{key:"exportImage",value:function(){return this.template.exportImage(),this}},{key:"destroy",value:function(){this.isDestroy=!0,this.events.destroy(),this.template.destroy(),this.controller.destroy(),this.decoder.destroy(),this.loader.destroy(),rt.splice(rt.indexOf(this),1)}},{key:"currentTime",get:function(){return this.options.mediaElement?this.options.mediaElement.currentTime:this._currentTime}},{key:"duration",get:function(){return this.options.mediaElement?this.options.mediaElement.duration:function(t){return g.t2d(t)}("99:59:59.999")}},{key:"playing",get:function(){var t=this.options.mediaElement;return!!t&&!!(0<t.currentTime&&!t.paused&&!t.ended&&2<t.readyState)}}]),n}()});
